(function(){var e={7307:function(e,l,t){"use strict";t.r(l);var a=t(1601),o=t.n(a),n=t(6314),r=t.n(n),u=r()(o());u.push([e.id,"#table-vue{font-family:Avenir,Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-align:center;color:#2c3e50}table{table-layout:fixed;border:2px solid #9b9b9b}th{background-color:azure}#top-th,th{width:100px}#top-th{height:40px;overflow:hidden}#null-cell{width:25px;background-color:azure}td{width:100px;height:25px;background-color:#faebd7}#index{width:25px}",""]),l["default"]=u},4094:function(e,l,t){"use strict";t.r(l);var a=t(1601),o=t.n(a),n=t(6314),r=t.n(n),u=r()(o());u.push([e.id,"input{width:100%;box-sizing:border-box}select{height:23px;width:90%}.select-cell,select{text-align:center}",""]),l["default"]=u},9210:function(e,l,t){"use strict";t.r(l);var a=t(1601),o=t.n(a),n=t(6314),r=t.n(n),u=r()(o());u.push([e.id,".formula{font-size:small;color:dimgray}.head-cell{overflow:hidden;width:85px}.head-cell,input{box-sizing:border-box}input{width:100%}",""]),l["default"]=u},5861:function(e,l,t){"use strict";var a=t(6768),o=t(144),n=t(4232),r=t(5130);const u=["disabled"],i=["value"],c={key:2};var s={__name:"Cell",props:["line","col"],setup(e){const l=e,t=(0,a.WQ)("store"),s=(0,o.KR)(!1),d=(0,o.KR)(),f=(0,a.EW)((()=>"true"==t.headCellByKey(l.col).readonly||t.headCellByKey(l.col).formula)),h=(0,o.KR)("select"==t.headCellByKey(l.col).type);function p(){return t.headCellByKey(l.col).formula}function b(e){t.tableData[l.line][l.col]=e.target.value,s.value=!1}(0,a.sV)((()=>{d.value=t.headCellByKey(l.col).type,console.log("dima refs:",f,d.value)}));const v=(0,a.EW)((()=>"formula"==d.value?(t.tableData[l.line][l.col]=t.calcFormula(p(),l.line,l.col),console.log(t.tableData),t.tableData[l.line][l.col]):t.tableData[l.line][l.col]));return(e,d)=>((0,a.uX)(),(0,a.CE)("div",{class:(0,n.C4)(h.value?"select-cell":""),onClick:d[2]||(d[2]=e=>s.value=!0)},["select"==(0,o.R1)(t).headCellByKey(l.col).type?(0,a.bo)(((0,a.uX)(),(0,a.CE)("select",{key:0,"onUpdate:modelValue":d[0]||(d[0]=e=>(0,o.R1)(t).tableData[l.line][l.col]=e),disabled:f.value},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,o.R1)(t).headCellByKey(l.col).selectList,(e=>((0,a.uX)(),(0,a.CE)("option",null,(0,n.v_)(e),1)))),256))],8,u)),[[r.u1,(0,o.R1)(t).tableData[l.line][l.col]]]):s.value&&!f.value?((0,a.uX)(),(0,a.CE)("input",{key:1,value:v.value,onChange:b,onBlur:b,onVnodeMounted:d[1]||(d[1]=({el:e})=>e.focus())},null,40,i)):((0,a.uX)(),(0,a.CE)("span",c,(0,n.v_)(v.value),1))],2))}};t(3035);const d=s;var f=d;t(8992),t(2577);const h=(0,o.Kh)({rawTableData:{},tableData:{},tableHead:{},init(e){this.rawTableData=JSON.parse(e),this.tableData=this.rawTableData.data,this.tableHead=this.rawTableData.head,0==this.tableData.length||0==this.tableHead.length?console.error("tableApp: Incoming data error",this.tableData,this.tableHead):console.log("tableApp: Store initiated")},headCellByKey(e){return this.tableHead.find((l=>l.key==e))},calcFormula(e,l,t){if("="!==e[0])return"ERR";try{const o=e.slice(1);return n(o,0,{sign:1,colName:""});function n(e,l,t){return 0==e.length?""==t.colName?l:r(e,l,t):"-"==e[0]||"+"==e[0]?r(e,l,t):e[0].match(/[a-zA-Z]/)&&(""==t.colName||t.match(/[a-zA-Z]/))?(t.colName=t.colName+e[0],void 0===t.sign&&(t.sign=1),n(e.slice(1),l,t)):isNaN(e[0])&&"."!=e[0]||""!=t.colName&&isNaN(t.colName)?"ERR":(t.colName=t.colName+e[0],void 0===t.sign&&(t.sign=1),n(e.slice(1),l,t))}function r(e,a,o){if(""!==o.colName||void 0!==o.colName){if(isNaN(o.colName)){if(o.colName==t)throw new Error("Cycle links");u(t,o.colName),a+=parseFloat(h.tableData[l][o.colName])*o.sign}else a+=parseFloat(o.colName)*o.sign;o.sign=1}return o.colName="","-"!=e[0]&&"+"!=e[0]||(o.sign="+"==e[0]?1:-1),n(e.slice(1),a,o)}function u(e,l){if("formula"!=h.headCellByKey(l).type)return;const t=h.headCellByKey(l).formula;if(t.includes(e)){const l=t.indexOf(e);if(t[l-1].match(/[a-zA-Z]/)||t[l+e.length].match(/[a-zA-Z]/))return;throw new Error("Cycle links")}}}catch(a){return"ERR"+a}}});const p=["value"],b={key:1,class:"formula"};var v={__name:"HeadCell",props:["cellKey"],setup(e){const l=(0,a.WQ)("store"),t=e,r=l.headCellByKey(t.cellKey),u=(0,o.KR)(!1);function i(e){l.headCellByKey(t.cellKey).formula=e.target.value,u.value=!1}return(l,t)=>((0,a.uX)(),(0,a.CE)("div",{class:"head-cell",onClick:t[1]||(t[1]=e=>u.value=!0)},[(0,a.Lk)("span",null,(0,n.v_)(e.cellKey),1),"formula"==(0,o.R1)(r).type&&"false"==(0,o.R1)(r).readonly&&u.value?((0,a.uX)(),(0,a.CE)("input",{key:0,value:(0,o.R1)(r).formula,onChange:i,onBlur:i,onVnodeMounted:t[0]||(t[0]=({el:e})=>e.focus())},null,40,p)):"formula"==(0,o.R1)(r).type?((0,a.uX)(),(0,a.CE)("span",b,[t[2]||(t[2]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" "+(0,n.v_)((0,o.R1)(r).formula.slice(1)),1)])):(0,a.Q3)("",!0)]))}};t(5743);const y=v;var m=y;const g={id:"top-th"},C={id:"index"};var w={__name:"AppTable",props:["tableDataAsJSON"],setup(e){const l=e;return(0,a.Gt)("store",h),(0,a.sV)((()=>{h.init(tableDataAsJSON),console.log("dima props tableDataAsJSON:",l.tableDataAsJSON),console.log("store: ",h)})),(e,l)=>((0,a.uX)(),(0,a.CE)("table",null,[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[l[0]||(l[0]=(0,a.Lk)("th",{id:"null-cell"},null,-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,o.R1)(h).tableHead,(e=>((0,a.uX)(),(0,a.CE)("th",g,[(0,a.bF)(m,{cellKey:e.key},null,8,["cellKey"])])))),256))])]),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,o.R1)(h).tableData,((e,l)=>((0,a.uX)(),(0,a.CE)("tr",null,[(0,a.Lk)("th",C,(0,n.v_)(l+1),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Object.keys(e),(e=>((0,a.uX)(),(0,a.CE)("td",null,[(0,a.bF)(f,{line:l,col:e},null,8,["line","col"])])))),256))])))),256))])]))}};t(1012);const N=w;var k=N;class x{static mountNewTable(e,l){const t=(0,r.Ef)(k,l);t.mount(e)}}window.TableVue=x},1012:function(e,l,t){var a=t(7307);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var o=t(8459).A;o("a02e63ce",a,!0,{sourceMap:!1,shadowMode:!1})},3035:function(e,l,t){var a=t(4094);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var o=t(8459).A;o("1353775e",a,!0,{sourceMap:!1,shadowMode:!1})},5743:function(e,l,t){var a=t(9210);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var o=t(8459).A;o("d133c7dc",a,!0,{sourceMap:!1,shadowMode:!1})}},l={};function t(a){var o=l[a];if(void 0!==o)return o.exports;var n=l[a]={id:a,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(l,a,o,n){if(!a){var r=1/0;for(s=0;s<e.length;s++){a=e[s][0],o=e[s][1],n=e[s][2];for(var u=!0,i=0;i<a.length;i++)(!1&n||r>=n)&&Object.keys(t.O).every((function(e){return t.O[e](a[i])}))?a.splice(i--,1):(u=!1,n<r&&(r=n));if(u){e.splice(s--,1);var c=o();void 0!==c&&(l=c)}}return l}n=n||0;for(var s=e.length;s>0&&e[s-1][2]>n;s--)e[s]=e[s-1];e[s]=[a,o,n]}}(),function(){t.n=function(e){var l=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(l,{a:l}),l}}(),function(){t.d=function(e,l){for(var a in l)t.o(l,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:l[a]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,l){return Object.prototype.hasOwnProperty.call(e,l)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};t.O.j=function(l){return 0===e[l]};var l=function(l,a){var o,n,r=a[0],u=a[1],i=a[2],c=0;if(r.some((function(l){return 0!==e[l]}))){for(o in u)t.o(u,o)&&(t.m[o]=u[o]);if(i)var s=i(t)}for(l&&l(a);c<r.length;c++)n=r[c],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(s)},a=self["webpackChunktable_component"]=self["webpackChunktable_component"]||[];a.forEach(l.bind(null,0)),a.push=l.bind(null,a.push.bind(a))}();var a=t.O(void 0,[504],(function(){return t(5861)}));a=t.O(a)})();